package CountryPosition

// Written in Go by Baptiste Jamin, Brittany, 2013
// Used from: https://developers.google.com/public-data/docs/canonical/countries_csv

import (
  "strconv"
  "fmt"
)

type CountryPosition struct {
  countryMapper map[string][]string
}

// New returns a new API client
func New() *CountryPosition {
  positions := &CountryPosition{}

  positions.countryMapper = map[string][]string{
    "AD": []string{"42.546245", "1.601554",   "Andorra"},
    "AE": []string{"23.424076", "53.847818",  "United Arab Emirates"},
    "AF": []string{"33.93911",  "67.709953",  "Afghanistan"},
    "AG": []string{"17.060816", "-61.796428", "Antigua and Barbuda"},
    "AI": []string{"18.220554", "-63.068615", "Anguilla"},
    "AL": []string{"41.153332", "20.168331",  "Albania"},
    "AM": []string{"40.069099", "45.038189",  "Armenia"},
    "AN": []string{"12.226079", "-69.060087", "Netherlands Antilles"},
    "AO": []string{"-11.202692",  "17.873887",  "Angola"},
    "AQ": []string{"-75.250973",  "-0.071389",  "Antarctica"},
    "AR": []string{"-38.416097",  "-63.616672", "Argentina"},
    "AS": []string{"-14.270972",  "-170.132217",  "American Samoa"},
    "AT": []string{"47.516231", "14.550072",  "Austria"},
    "AU": []string{"-25.274398",  "133.775136", "Australia"},
    "AW": []string{"12.52111",  "-69.968338", "Aruba"},
    "AZ": []string{"40.143105", "47.576927",  "Azerbaijan"},
    "BA": []string{"43.915886", "17.679076",  "Bosnia and Herzegovina"},
    "BB": []string{"13.193887", "-59.543198", "Barbados"},
    "BD": []string{"23.684994", "90.356331",  "Bangladesh"},
    "BE": []string{"50.503887", "4.469936",   "Belgium"},
    "BF": []string{"12.238333", "-1.561593",  "Burkina Faso"},
    "BG": []string{"42.733883", "25.48583",   "Bulgaria"},
    "BH": []string{"25.930414", "50.637772",  "Bahrain"},
    "BI": []string{"-3.373056", "29.918886",  "Burundi"},
    "BJ": []string{"9.30769",   "2.315834",   "Benin"},
    "BM": []string{"32.321384", "-64.75737",  "Bermuda"},
    "BN": []string{"4.535277",  "114.727669", "Brunei",""},
    "BO": []string{"-16.290154",  "-63.588653", "Bolivia"},
    "BR": []string{"-14.235004",  "-51.92528",  "Brazil"},
    "BS": []string{"25.03428",  "-77.39628",  "Bahamas"},
    "BT": []string{"27.514162", "90.433601",  "Bhutan"},
    "BV": []string{"-54.423199",  "3.413194",   "Bouvet Island"},
    "BW": []string{"-22.328474",  "24.684866",  "Botswana"},
    "BY": []string{"53.709807", "27.953389",  "Belarus"},
    "BZ": []string{"17.189877", "-88.49765",  "Belize"},
    "CA": []string{"56.130366", "-106.346771",  "Canada"},
    "CC": []string{"-12.164165",  "96.870956",  "Cocos [Keeling] Islands"},
    "CD": []string{"-4.038333", "21.758664",  "Congo [DRC]"},
    "CF": []string{"6.611111",   "20.939444",  "Central African Republic"},
    "CG": []string{"-0.228021", "15.827659",  "Congo [Republic]"},
    "CH": []string{"46.818188", "8.227512",   "Switzerland"},
    "CI": []string{"7.539989",  "-5.54708",   "Côte d'Ivoire"},
    "CK": []string{"-21.236736",  "-159.777671",  "Cook Islands"},
    "CL": []string{"-35.675147",  "-71.542969", "Chile"},
    "CM": []string{"7.369722",  "12.354722",  "Cameroon"},
    "CN": []string{"35.86166",  "104.195397", "China"},
    "CO": []string{"4.570868",  "-74.297333", "Colombia"},
    "CR": []string{"9.748917",  "-83.753428", "Costa Rica"},
    "CU": []string{"21.521757", "-77.781167", "Cuba"},
    "CV": []string{"16.002082", "-24.013197", "Cape Verde"},
    "CX": []string{"-10.447525",  "105.690449", "Christmas Island"},
    "CY": []string{"35.126413", "33.429859",  "Cyprus"},
    "CZ": []string{"49.817492", "15.472962",  "Czech Republic"},
    "DE": []string{"51.165691", "10.451526",  "Germany"},
    "DJ": []string{"11.825138", "42.590275",  "Djibouti"},
    "DK": []string{"56.26392",  "9.501785",   "Denmark"},
    "DM": []string{"15.414999", "-61.370976", "Dominica"},
    "DO": []string{"18.735693", "-70.162651", "Dominican Republic"},
    "DZ": []string{"28.033886", "1.659626",   "Algeria"},
    "EC": []string{"-1.831239", "-78.183406", "Ecuador"},
    "EE": []string{"58.595272", "25.013607",  "Estonia"},
    "EG": []string{"26.820553", "30.802498",  "Egypt"},
    "EH": []string{"24.215527", "-12.885834", "Western Sahara"},
    "ER": []string{"15.179384", "39.782334",  "Eritrea"},
    "ES": []string{"40.463667", "-3.74922",   "Spain"},
    "ET": []string{"9.145",   "40.489673",  "Ethiopia"},
    "FI": []string{"61.92411",  "25.748151",  "Finland"},
    "FJ": []string{"-16.578193",  "179.414413", "Fiji"},
    "FK": []string{"-51.796253",  "-59.523613", "Falkland Islands [Islas Malvinas]"},
    "FM": []string{"7.425554",  "150.550812", "Micronesia"},
    "FO": []string{"61.892635", "-6.911806",  "Faroe Islands"},
    "FR": []string{"46.227638", "2.213749",   "France"},
    "GA": []string{"-0.803689", "11.609444",  "Gabon"},
    "GB": []string{"55.378051", "-3.435973",  "United Kingdom"},
    "GD": []string{"12.262776", "-61.604171", "Grenada"},
    "GE": []string{"42.315407", "43.356892",  "Georgia"},
    "GF": []string{"3.933889",  "-53.125782", "French Guiana"},
    "GG": []string{"49.465691", "-2.585278",  "Guernsey"},
    "GH": []string{"7.946527",  "-1.023194",  "Ghana"},
    "GI": []string{"36.137741", "-5.345374",  "Gibraltar"},
    "GL": []string{"71.706936", "-42.604303", "Greenland"},
    "GM": []string{"13.443182", "-15.310139", "Gambia"},
    "GN": []string{"9.945587",  "-9.696645",  "Guinea"},
    "GP": []string{"16.995971", "-62.067641", "Guadeloupe"},
    "GQ": []string{"1.650801",  "10.267895",  "Equatorial", "Guinea"},
    "GR": []string{"39.074208", "21.824312",  "Greece"},
    "GS": []string{"-54.429579",  "-36.587909", "South Georgia and the South Sandwich Islands"},
    "GT": []string{"15.783471", "-90.230759", "Guatemala"},
    "GU": []string{"13.444304", "144.793731", "Guam"},
    "GW": []string{"11.803749", "-15.180413", "Guinea-Bissau"},
    "GY": []string{"4.860416m", "-58.93018",  "Guyana"},
    "GZ": []string{"31.354676", "34.308825",  "Gaza Strip"},
    "HK": []string{"22.396428", "114.109497", "Hong Kong"},
    "HM": []string{"-53.08181", "73.504158",  "Heard Island and McDonald Islands"},
    "HN": []string{"15.199999", "-86.241905", "Honduras"},
    "HR": []string{"45.1",    "15.2",     "Croatia"},
    "HT": []string{"18.971187", "-72.285215", "Haiti"},
    "HU": []string{"47.162494", "19.503304",  "Hungary"},
    "ID": []string{"-0.789275", "113.921327", "Indonesia"},
    "IE": []string{"53.41291",  "-8.24389",   "Ireland"},
    "IL": []string{"31.046051", "34.851612",  "Israel"},
    "IM": []string{"54.236107", "-4.548056",  "Isle of Man"},
    "IN": []string{"20.593684", "78.96288",   "India"},
    "IO": []string{"-6.343194", "71.876519",  "British Indian Ocean Territory"},
    "IQ": []string{"33.223191", "43.679291",  "Iraq"},
    "IR": []string{"32.427908", "53.688046",  "Iran"},
    "IS": []string{"64.963051", "-19.020835", "Iceland"},
    "IT": []string{"41.87194",  "12.56738",   "Italy"},
    "JE": []string{"49.214439", "-2.13125",   "Jersey"},
    "JM": []string{"18.109581", "-77.297508", "Jamaica"},
    "JO": []string{"30.585164", "36.238414",  "Jordan"},
    "JP": []string{"36.204824", "138.252924", "Japan"},
    "KE": []string{"-0.023559", "37.906193",  "Kenya"},
    "KG": []string{"41.20438",  "74.766098",  "Kyrgyzstan"},
    "KH": []string{"12.565679", "104.990963", "Cambodia"},
    "KI": []string{"-3.370417", "-168.734039",  "Kiribati"},
    "KM": []string{"-11.875001",  "43.872219",  "Comoros"},
    "KN": []string{"17.357822", "-62.782998", "Saint Kitts and Nevis"},
    "KP": []string{"40.339852", "127.510093", "North Korea"},
    "KR": []string{"35.907757", "127.766922", "South Korea"},
    "KW": []string{"29.31166",  "47.481766",  "Kuwait"},
    "KY": []string{"19.513469", "-80.566956", "Cayman Islands"},
    "KZ": []string{"48.019573", "66.923684",  "Kazakhstan"},
    "LA": []string{"19.85627",  "102.495496", "Laos"},
    "LB": []string{"33.854721", "35.862285",  "Lebanon"},
    "LC": []string{"13.909444", "-60.978893", "Saint Lucia"},
    "LI": []string{"47.166",    "9.555373",   "Liechtenstein"},
    "LK": []string{"7.873054",  "80.771797",  "Sri Lanka"},
    "LR": []string{"6.428055",  "-9.429499",  "Liberia"},
    "LS": []string{"-29.609988",  "28.233608",  "Lesotho"},
    "LT": []string{"55.169438", "23.881275",  "Lithuania"},
    "LU": []string{"49.815273", "6.129583",   "Luxembourg"},
    "LV": []string{"56.879635", "24.603189",  "Latvia"},
    "LY": []string{"26.3351",   "17.228331",  "Libya"},
    "MA": []string{"31.791702", "-7.09262",   "Morocco"},
    "MC": []string{"43.750298", "7.412841",   "Monaco"},
    "MD": []string{"47.411631", "28.369885",  "Moldova"},
    "ME": []string{"42.708678", "19.37439",   "Montenegro"},
    "MG": []string{"-18.766947",  "46.869107",  "Madagascar"},
    "MH": []string{"7.131474",  "171.184478", "Marshall Islands"},
    "MK": []string{"41.608635", "21.745275",  "Macedonia [FYROM]"},
    "ML": []string{"17.570692", "-3.996166",  "Mali"},
    "MM": []string{"21.913965", "95.956223",  "Myanmar [Burma]"},
    "MN": []string{"46.862496", "103.846656", "Mongolia"},
    "MO": []string{"22.198745", "113.543873", "Macau"},
    "MP": []string{"17.33083",  "145.38469",  "Northern Mariana Islands"},
    "MQ": []string{"14.641528", "-61.024174", "Martinique"},
    "MR": []string{"21.00789",  "-10.940835", "Mauritania"},
    "MS": []string{"16.742498", "-62.187366", "Montserrat"},
    "MT": []string{"35.937496", "14.375416",  "Malta"},
    "MU": []string{"-20.348404",  "57.552152",  "Mauritius"},
    "MV": []string{"3.202778",  "73.22068",   "Maldives"},
    "MW": []string{"-13.254308",  "34.301525",  "Malawi"},
    "MX": []string{"23.634501", "-102.552784",  "Mexico"},
    "MY": []string{"4.210484",  "101.975766", "Malaysia",""},
    "MZ": []string{"-18.665695",  "35.529562",  "Mozambique"},
    "NA": []string{"-22.95764", "18.49041",   "Namibia"},
    "NC": []string{"-20.904305",  "165.618042", "New Caledonia"},
    "NE": []string{"17.607789", "8.081666",   "Niger"},
    "NF": []string{"-29.040835",  "167.954712", "Norfolk Island"},
    "NG": []string{"9.081999",  "8.675277",   "Nigeria"},
    "NI": []string{"12.865416", "-85.207229", "Nicaragua"},
    "NL": []string{"52.132633", "5.291266",   "Netherlands"},
    "NO": []string{"60.472024", "8.468946",   "Norway"},
    "NP": []string{"28.394857", "84.124008",  "Nepal"},
    "NR": []string{"-0.522778", "166.931503", "Nauru"},
    "NU": []string{"-19.054445",  "-169.867233",  "Niue"},
    "NZ": []string{"-40.900557",  "174.885971", "New Zealand"},
    "OM": []string{"21.512583", "55.923255",  "Oman"},
    "PA": []string{"8.537981",  "-80.782127", "Panama"},
    "PE": []string{"-9.189967", "-75.015152", "Peru"},
    "PF": []string{"-17.679742",  "-149.406843",  "French Polynesia"},
    "PG": []string{"-6.314993", "143.95555",  "Papua New Guinea"},
    "PH": []string{"12.879721", "121.774017", "Philippines"},
    "PK": []string{"30.375321", "69.345116",  "Pakistan"},
    "PL": []string{"51.919438", "19.145136",  "Poland"},
    "PM": []string{"46.941936", "-56.27111",  "Saint Pierre and Miquelon"},
    "PN": []string{"-24.703615",  "-127.439308",  "Pitcairn Islands"},
    "PR": []string{"18.220833", "-66.590149", "Puerto Rico"},
    "PS": []string{"31.952162", "35.233154",  "Palestinian Territories"},
    "PT": []string{"39.399872", "-8.224454",  "Portugal"},
    "PW": []string{"7.51498",   "134.58252",  "Palau"},
    "PY": []string{"-23.442503",  "-58.443832", "Paraguay"},
    "QA": []string{"25.354826", "51.183884",  "Qatar"},
    "RE": []string{"-21.115141",  "55.536384",  "Réunion"},
    "RO": []string{"45.943161", "24.96676",   "Romania"},
    "RS": []string{"44.016521", "21.005859",  "Serbia"},
    "RU": []string{"61.52401",  "105.318756", "Russia"},
    "RW": []string{"-1.940278", "29.873888",  "Rwanda"},
    "SA": []string{"23.885942", "45.079162",  "Saudi Arabia"},
    "SB": []string{"-9.64571",  "160.156194", "Solomon Islands"},
    "SC": []string{"-4.679574", "55.491977",  "Seychelles"},
    "SD": []string{"12.862807", "30.217636",  "Sudan"},
    "SE": []string{"60.128161", "18.643501",  "Sweden"},
    "SG": []string{"1.352083",  "103.819836", "Singapore",""},
    "SH": []string{"-24.143474",  "-10.030696", "Saint Helena"},
    "SI": []string{"46.151241", "14.995463",  "Slovenia"},
    "SJ": []string{"77.553604", "23.670272",  "Svalbard and Jan Mayen"},
    "SK": []string{"48.669026", "19.699024",  "Slovakia"},
    "SL": []string{"8.460555",  "-11.779889", "Sierra Leone"},
    "SM": []string{"43.94236",  "12.457777",  "San Marino"},
    "SN": []string{"14.497401", "-14.452362", "Senegal"},
    "SO": []string{"5.152149",  "46.199616",  "Somalia"},
    "SR": []string{"3.919305",  "-56.027783", "Suriname"},
    "ST": []string{"0.18636",   "6.613081",   "São Tomé and Príncipe"},
    "SV": []string{"13.794185", "-88.89653",  "El Salvador"},
    "SY": []string{"34.802075", "38.996815",  "Syria"},
    "SZ": []string{"-26.522503",  "31.465866",  "Swaziland"},
    "TC": []string{"21.694025", "-71.797928", "Turks and Caicos Islands"},
    "TD": []string{"15.454166", "18.732207",  "Chad"},
    "TF": []string{"-49.280366",  "69.348557",  "French Southern Territories"},
    "TG": []string{"8.619543",  "0.824782",   "Togo"},
    "TH": []string{"15.870032", "100.992541", "Thailand"},
    "TJ": []string{"38.861034", "71.276093",  "Tajikistan"},
    "TK": []string{"-8.967363", "-171.855881",  "Tokelau"},
    "TL": []string{"-8.874217", "125.727539", "Timor-Leste"},
    "TM": []string{"38.969719", "59.556278",  "Turkmenistan"},
    "TN": []string{"33.886917", "9.537499",   "Tunisia"},
    "TO": []string{"-21.178986",  "-175.198242",  "Tonga"},
    "TR": []string{"38.963745", "35.243322",  "Turkey"},
    "TT": []string{"10.691803", "-61.222503", "Trinidad and Tobago"},
    "TV": []string{"-7.109535", "177.64933",  "Tuvalu"},
    "TW": []string{"23.69781",  "120.960515", "Taiwan"},
    "TZ": []string{"-6.369028", "34.888822",  "Tanzania"},
    "UA": []string{"48.379433", "31.16558",   "Ukraine"},
    "UG": []string{"1.373333",  "32.290275",  "Uganda",""},
    "US": []string{"37.09024",  "-95.712891", "United States"},
    "UY": []string{"-32.522779",  "-55.765835", "Uruguay"},
    "UZ": []string{"41.377491", "64.585262",  "Uzbekistan"},
    "VA": []string{"41.902916", "12.453389",  "Vatican City"},
    "VC": []string{"12.984305", "-61.287228", "Saint Vincent and the Grenadines"},
    "VE": []string{"6.42375",   "-66.58973",  "Venezuela",""},
    "VG": []string{"18.420695", "-64.639968", "British Virgin Islands"},
    "VI": []string{"18.335765", "-64.896335", "U.S. Virgin Islands"},
    "VN": []string{"14.058324", "108.277199", "Vietnam"},
    "VU": []string{"-15.376706",  "166.959158", "Vanuatu"},
    "WF": []string{"-13.768752",  "-177.156097",  "Wallis and Futuna"},
    "WS": []string{"-13.759029",  "-172.104629",  "Samoa"},
    "XK": []string{"42.602636", "20.902977",  "Kosovo"},
    "YE": []string{"15.552727", "48.516388",  "Yemen"},
    "YT": []string{"-12.8275",  "45.166244",  "Mayotte"},
    "ZA": []string{"-30.559482",  "22.937506",  "South Africa"},
    "ZM": []string{"-13.133897",  "27.849332",  "Zambia"},
    "ZW": []string{"-19.015438",  "29.154857",  "Zimbabwe"},
  }

  return positions;
}

func (countryPosition *CountryPosition) GetCoordinatesFromCode(code string) ([]float32, error) {

  var location []float32

  location = make([]float32, 2)

  if (countryPosition.countryMapper[code] == nil) {
    return nil, fmt.Errorf("CountryPosition: Can't get position for %f", code)
  }

  parsedLocation, err := strconv.ParseFloat(countryPosition.countryMapper[code][0], 32)

  if (err == nil) {
    location[0] = float32(parsedLocation);
  }

  parsedLocation, err = strconv.ParseFloat(countryPosition.countryMapper[code][1], 32)
  
  if (err == nil) {
    location[1] = float32(parsedLocation);
  }

  return location, nil
}


func (countryPosition *CountryPosition) GetCountryFromCode(code string) (string, error) {

  if (countryPosition.countryMapper[code] == nil) {
    return "", fmt.Errorf("CountryPosition: Can't get position for %f", code)
  }

  return countryPosition.countryMapper[code][2], nil
}